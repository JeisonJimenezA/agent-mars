# PYTHON MODULE IMPLEMENTATION

## CRITICAL RULES (READ FIRST - VIOLATIONS CAUSE CRASHES)

### 1. Dataclass Mutable Defaults (MOST COMMON ERROR)
```python
# WRONG - WILL CRASH:
@dataclass
class Config:
    layers: List[int] = []           # CRASHES!
    params: Dict = {{}}               # CRASHES!

# CORRECT:
from dataclasses import dataclass, field
@dataclass
class Config:
    layers: List[int] = field(default_factory=list)
    params: Dict = field(default_factory=dict)
```

### 2. Encoding & Characters
- **NO EMOJIS**: Use ASCII only. Windows crashes on emoji characters.
- **FILE ENCODING**: Always use `encoding='utf-8'` when opening files.
- **NO PARQUET**: Use `.to_csv()` not `.to_parquet()` (PyArrow not installed).

### 3. Data Types
- **y_train**: Must be 1D integer array (0, 1, 2...), NOT one-hot, NOT probabilities.
- **Statistics**: Never compute class_weights with placeholder data. Load real data first.

### 4. API Compatibility
- **LightGBM**: Use `callbacks=[lgb.early_stopping(100)]` not `early_stopping_rounds=`
- **XGBoost**: Use 1D integer labels for multiclass, not one-hot.

---

## OUTPUT FORMAT

Provide COMPLETE working code in a single ```python block:

```python
# {file_name}
# Your implementation here
```

**SIZE LIMIT**: Keep under 400 lines. Prioritize working code over comprehensive code.

---

## YOUR TASK

Implement module: `{file_name}`

**Description**: {file_description}

---

## CONTEXT

### Problem Description
{problem_description}

### EDA Report
{eda_report}

### Solution Approach
{idea}

### Data Locations
- Training: `./train.csv`
- Test: `./test.csv`
- Sample submission: `./sample_submission.csv` or `./input/sample_submission.csv`
- Cache directory: `./working/cache/`

---

## EXISTING MODULES (import from these, do not reimplement)

{library_files}

---

## IMPLEMENTATION REQUIREMENTS

1. **Imports**: Import from existing modules above, don't reimplement.
2. **No main block**: Do NOT include `if __name__ == "__main__":`
3. **Hyperparameters**: Include arguments for dataset size and training steps.
4. **Metrics**: Print full precision without rounding.

### If this module loads data:
- Use `load_cached_data: bool` parameter
- Cache to `./working/cache/` using CSV or NPY (NO pickle, NO parquet)
- Create cache dir: `os.makedirs('./working/cache/', exist_ok=True)`

### If this module trains models:
- Print training/validation metrics during training
- Implement Early Stopping

### If this module generates submissions:
- Save to `./submission/submission.csv`
- Match format from sample submission file

---

Now implement the complete `{file_name}` module:
