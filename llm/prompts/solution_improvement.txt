==== Problem ====
{problem_description}

==== Current Solution ====
{previous_solution}

==== Current Performance ====
{current_metric}

==== Lessons ====
{lessons}

==== Task ====
Your task is to modify the Python files from the previous solution to
optimize performance.

# Requirements
- Modifications must be targeted and specific (ablation-style). Do not
rewrite the entire solution; focus on isolating and improving specific
aspects.
- You should apply the relevant knowledge provided in the Lessons section
to support your optimization strategy. Whenever you apply a specific
concept or solution from these lessons, you must immediately reference
it by appending "Cite {{lesson_id}}" to the relevant statement.
- Optimize hyperparameter settings (e.g., training steps, learning rate,
batch size) to strike the best balance between predictive performance
and execution speed.
- **Do not remove** the following core logic from the original script:
  - Print the final validation metric computed on the entire hold-out
    validation set.
  - Perform failure analysis on the trained model.
  - Generate predictions for the entire test set and create the
    submission file.

# Modification Types to Consider
1. Hyperparameter tuning (learning rate, batch size, epochs, early stopping)
2. Feature engineering (new features, transformations, encoding)
3. Model architecture tweaks (layers, regularization, dropout, activation)
4. Training strategy (optimizer, scheduler, loss function, callbacks)
5. Data preprocessing (scaling, imputation, augmentation)

# Response Format
Propose 1-3 modifications. For each:

**Modification [N]: [Brief Title]**
Reasoning: [Why this helps - cite lessons: "Cite {lesson_id}"]
Target File: [filename.py]
Change Type: [hyperparameter|architecture|feature|training|data]

Specific Changes:
- [Describe change 1]
- [Describe change 2]

Code Modification:
```python
# In [filename.py]:
# OLD:
[exact old code snippet - must be UNIQUE in file]

# NEW:
[new code snippet]
```

CRITICAL RULES:
- OLD code must appear EXACTLY ONCE in the target file
- Preserve exact indentation and syntax
- Keep changes minimal (3-10 lines per modification)
- Do NOT regenerate entire files
- Focus on high-impact, low-risk changes